{% extends 'accounts/dashboard.html' %}
{% load static %}
{% block title %}Site Settings{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="card shadow-sm p-4">
    <h2 class="text-center mb-4">Site Settings</h2>

    <!-- Site Settings Form -->
    <form method="POST" class="row g-3">
      {% csrf_token %}

      <!-- General Info -->
      <div class="col-md-4">
        <label class="form-label">Site Name</label>
        {{ form.name }}
      </div>
      <div class="col-md-4">
        <label class="form-label">Site Title</label>
        {{ form.title }}
      </div>

      <!-- Logo Upload -->
      <div class="col-md-6">
        <label class="form-label">Logo (Select Existing)</label>
        {{ form.logo }}
        {% if form.instance.logo %}
          <img src="{{ form.instance.logo.image.url }}" alt="Logo" class="img-fluid rounded mt-2" style="max-height: 100px;">
        {% endif %}
        <form method="POST" enctype="multipart/form-data" action="{% url 'media_upload' %}" class="mt-2 d-flex gap-2">
          {% csrf_token %}
          <input type="hidden" name="target" value="logo">
          <input type="file" name="image" class="form-control">
          <button type="submit" class="btn btn-sm btn-secondary">Upload New Logo</button>
        </form>
      </div>

      <!-- Favicon Upload -->
      <div class="col-md-6">
        <label class="form-label">Favicon (Select Existing)</label>
        {{ form.favicon }}
        {% if form.instance.favicon %}
          <img src="{{ form.instance.favicon.image.url }}" alt="Favicon" class="img-fluid rounded mt-2" style="max-height: 50px;">
        {% endif %}
        <form method="POST" enctype="multipart/form-data" action="{% url 'media_upload' %}" class="mt-2 d-flex gap-2">
          {% csrf_token %}
          <input type="hidden" name="target" value="favicon">
          <input type="file" name="image" class="form-control">
          <button type="submit" class="btn btn-sm btn-secondary">Upload New Favicon</button>
        </form>
      </div>

      <!-- Carousel Images Upload -->
      <h5 class="border-bottom pb-2 mt-4">Carousel Images</h5>
      {% for item in carousel_fields %}
        <div class="col-md-4">
          <label class="form-label">{{ item.field.label }} (Select Existing)</label>
          {{ item.field }}
          {% if item.image_url %}
            <img src="{{ item.image_url }}" alt="Carousel Image" class="img-fluid rounded mt-2" style="max-height: 100px;">
          {% endif %}
          <form method="POST" enctype="multipart/form-data" action="{% url 'media_upload' %}" class="mt-2 d-flex gap-2">
            {% csrf_token %}
            <input type="hidden" name="target" value="{{ item.field.name }}">
            <input type="file" name="image" class="form-control">
            <button type="submit" class="btn btn-sm btn-secondary">Upload New</button>
          </form>
        </div>
      {% endfor %}

      <!-- Contact Info -->
      <h5 class="border-bottom pb-2 mt-4">Contact Information</h5>
      <div class="col-md-4">
        <label class="form-label">Phone</label>
        {{ form.phone }}
      </div>
      <div class="col-md-4">
        <label class="form-label">Email</label>
        {{ form.email }}
      </div>
      <div class="col-md-4">
        <label class="form-label">Address</label>
        {{ form.address }}
      </div>

      <!-- Social Links -->
      <h5 class="border-bottom pb-2 mt-4">Social Media</h5>
      <div class="col-md-3">
        <label class="form-label">Facebook</label>
        {{ form.facebook }}
      </div>
      <div class="col-md-3">
        <label class="form-label">Instagram</label>
        {{ form.instagram }}
      </div>
      <div class="col-md-3">
        <label class="form-label">Twitter</label>
        {{ form.twitter }}
      </div>
      <div class="col-md-3">
        <label class="form-label">X</label>
        {{ form.x }}
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary">Save Settings</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block js_customs %}
<script>
  $(document).ready(function() {
    $('.select2').select2({
      width: '100%',
      placeholder: 'Select an image',
      allowClear: true
    });
  });
</script>
{% endblock %}
